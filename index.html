<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <title>ğŸ” Ø¨Ø­Ø« Ø§Ù„Ø£ØµÙ†Ø§Ù - Ø¯Ø¨ÙˆØ³ Ø§Ù„Ø¨Ø³Ø·Ø©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; direction: rtl; text-align: right; margin: 20px; }
        h1 { color: #0056b3; }
        input, button { padding: 6px 10px; margin: 4px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
        th { background: #0056b3; color: white; }
        tr:nth-child(even) { background: #f9f9f9; }
        .note { color: #888; font-size: 12px; }
    </style>
</head>
<body>
    <h1>ğŸ” Ø¨Ø­Ø« Ø§Ù„Ø£ØµÙ†Ø§Ù - Ø¯Ø¨ÙˆØ³ Ø§Ù„Ø¨Ø³Ø·Ø©</h1>
    <p class="note">Ø§Ù„Ù…Ù„Ù ÙŠÙØ­Ù…Ù‘ÙÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø¨Ø§Ø³Ù… <b>Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx</b></p>

    <div>
        <input type="text" id="search1" placeholder="ÙƒÙ„Ù…Ø© Ø¨Ø­Ø« 1 (Ù…Ø«Ø§Ù„: Ø¯Ù‚)">
        <input type="text" id="search2" placeholder="ÙƒÙ„Ù…Ø© Ø¨Ø­Ø« 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
        <input type="text" id="search3" placeholder="ÙƒÙ„Ù…Ø© Ø¨Ø­Ø« 3 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
        <input type="text" id="warehouse" placeholder="Ø¬Ø²Ø¡ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
        <button onclick="search()">ğŸ” Ø¨Ø­Ø«</button>
    </div>

    <table id="results" style="display:none;">
        <thead>
            <tr>
                <th>Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹</th>
                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                <th>Ø§Ù„Ø¹Ø¯Ø¯</th>
                <th>Ø³Ø¹Ø± Ø§Ù„Ù…Ø¨ÙŠØ¹</th>
            </tr>
        </thead>
        <tbody id="resultsBody"></tbody>
    </table>

    <script>
    let data = [];

    // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù "Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx" ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯
    async function loadExcel() {
        try {
            const response = await fetch('Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx');
            if (!response.ok) {
                alert('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù "Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx" Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯.\nØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø´ØºØ§Ù„ ÙˆØ§Ù„Ù…Ù„Ù Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯.');
                return;
            }
            const arrayBuffer = await response.arrayBuffer();
            const dataUint8 = new Uint8Array(arrayBuffer);
            const workbook = XLSX.read(dataUint8, {type: 'array'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const allRows = XLSX.utils.sheet_to_json(sheet, {header:1});
            // Ø§Ù„ØµÙ 1 Ùˆ2 ÙÙˆÙ‚ØŒ Ø§Ù„ØµÙ 3 Ø±Ø¤ÙˆØ³ØŒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØµÙ 4
            data = allRows.slice(3);
            alert('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ' + data.length + ' ØµÙ†Ù Ù…Ù† "Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx".');
        } catch (e) {
            console.error(e);
            alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù "Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx". Ø±Ø§Ø¬Ø¹ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„.');
        }
    }

    function search() {
        if (data.length === 0) {
            alert('â— Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù…Ù„Ù "Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx" Ù…ÙˆØ¬ÙˆØ¯ ÙˆØ£Ù† Ø§Ù„ØµÙØ­Ø© Ø£Ø¹ÙŠØ¯ ØªØ­Ù…ÙŠÙ„Ù‡Ø§.');
            return;
        }

        const s1 = document.getElementById('search1').value.trim().toLowerCase();
        const s2 = document.getElementById('search2').value.trim().toLowerCase();
        const s3 = document.getElementById('search3').value.trim().toLowerCase();
        const wh = document.getElementById('warehouse').value.trim().toLowerCase();

        let results = data.filter(row => {
            const warehouse = ((row[1] || '') + '').toLowerCase(); // B
            const itemName  = ((row[2] || '') + '').toLowerCase(); // C

            const match1 = !s1 || itemName.includes(s1);
            const match2 = !s2 || itemName.includes(s2);
            const match3 = !s3 || itemName.includes(s3);
            const matchWh = !wh || warehouse.includes(wh);

            return match1 && match2 && match3 && matchWh;
        });

        // ØªØ±ØªÙŠØ¨ Ø£Ø¨Ø¬Ø¯ÙŠ Ø­Ø³Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©
        results.sort((a, b) => {
            const nameA = (a[2] || '').toString();
            const nameB = (b[2] || '').toString();
            return nameA.localeCompare(nameB, 'ar');
        });

        const tbody = document.getElementById('resultsBody');
        tbody.innerHTML = '';

        if (results.length === 0) {
            tbody.innerHTML = '<tr><td colspan="4" style="color:red;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©</td></tr>';
        } else {
            results.forEach(row => {
                const tr = document.createElement('tr');
                const warehouse = row[1] || '';
                const itemName  = row[2] || '';
                const qty       = row[3] || '';
                const price     = row[4] || '';

                tr.innerHTML = `
                    <td>${warehouse}</td>
                    <td>${itemName}</td>
                    <td>${qty}</td>
                    <td>${price}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        document.getElementById('results').style.display = 'table';
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    loadExcel();
    </script>
</body>
</html>
