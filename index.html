<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8" />
    <title>Ø¨Ø­Ø« Ø§Ù„Ø£ØµÙ†Ø§Ù - Ø¯Ø¨ÙˆØ³ Ø§Ù„Ø¨Ø³Ø·Ø©</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0056b3;
            --primary-light: #e6f0ff;
            --bg: #f5f7fb;
            --text: #222;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            direction: rtl;
            text-align: right;
            background: var(--bg);
            color: var(--text);
        }

        .app-shell {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: white;
            border-bottom: 1px solid #ddd;
            padding: 10px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .brand-logo {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            overflow: hidden;
            border: 1px solid #ddd;
            background: white;
            flex-shrink: 0;
        }

        .brand-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .brand-text-title {
            font-weight: 700;
            font-size: 18px;
            color: var(--primary);
        }

        .brand-text-sub {
            font-size: 12px;
            color: #666;
        }

        .status-pill {
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 999px;
            background: var(--primary-light);
            color: var(--primary);
            white-space: nowrap;
        }

        main {
            flex: 1;
            padding: 12px 16px 24px;
            max-width: 1100px;
            margin: 0 auto;
            width: 100%;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 12px 14px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.04);
            margin-bottom: 14px;
        }

        .card-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .note {
            font-size: 11px;
            color: #777;
            margin-top: 4px;
        }

        .search-grid {
            display: grid;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            gap: 8px;
        }

        .field-group {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        label {
            font-size: 11px;
            color: #555;
        }

        input[type="text"] {
            padding: 6px 8px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 13px;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 1px #c7ddff;
        }

        .search-actions {
            margin-top: 8px;
            display: flex;
            justify-content: flex-start;
            gap: 8px;
            flex-wrap: wrap;
        }

        button {
            border: none;
            cursor: pointer;
            border-radius: 999px;
            padding: 7px 14px;
            font-size: 13px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-secondary {
            background: #eee;
            color: #444;
        }

        .btn-primary:active,
        .btn-secondary:active {
            transform: translateY(1px);
        }

        .table-wrapper {
            width: 100%;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 8px;
            min-width: 480px;
        }

        th, td {
            border: 1px solid #e0e0e0;
            padding: 6px 4px;
            font-size: 12px;
        }

        th {
            background: var(--primary);
            color: white;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .no-results {
            text-align: center;
            padding: 16px 0;
            color: #c00;
        }

        @media (max-width: 768px) {
            header {
                padding: 8px 10px;
            }

            .brand-logo {
                width: 42px;
                height: 42px;
            }

            .brand-text-title {
                font-size: 16px;
            }

            main {
                padding: 10px 8px 18px;
            }

            .card {
                padding: 10px;
                margin-bottom: 10px;
            }

            .search-grid {
                grid-template-columns: 1fr 1fr;
            }

            table {
                font-size: 11px;
                min-width: 360px;
            }

            th, td {
                padding: 5px 3px;
            }
        }

        @media (max-width: 480px) {
            .search-grid {
                grid-template-columns: 1fr;
            }

            .status-pill {
                display: none;
            }

            .brand-text-sub {
                display: none;
            }
        }
    </style>
</head>
<body>
<div class="app-shell">
    <header>
        <div class="brand">
            <div class="brand-logo">
                <img src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø¯Ø¨ÙˆØ³ Ø§Ù„Ø¨Ø³Ø·Ø©" />
            </div>
            <div class="brand-text">
                <div class="brand-text-title">Ø¯Ø¨ÙˆØ³ Ø§Ù„Ø¨Ø³Ø·Ø©</div>
                <div class="brand-text-sub">Ù…Ø­Ø±Ùƒ Ø¨Ø­Ø« Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯ (Ù…Ø³ØªÙˆØ¯Ø¹ - Ù…Ø§Ø¯Ø© - Ø¹Ø¯Ø¯ - Ø³Ø¹Ø± Ù…Ø¨ÙŠØ¹)</div>
            </div>
        </div>
        <div class="status-pill">
            ğŸ“¦ Ù…Ù„Ù: Â«Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsxÂ»
        </div>
    </header>

    <main>
        <section class="card">
            <div class="card-title">ğŸ” ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø±Ø¯</div>
            <div class="note">
                ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù <b>Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx</b> ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯ (GitHub Pages). Ø¹Ù†Ø¯ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„ÙØŒ Ø§Ø±ÙØ¹ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ù†ÙØ³ Ø§Ù„Ø§Ø³Ù….
            </div>
            <div id="loadStatus" class="note" style="margin-top:6px;color:#c60;">
                Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
            </div>
        </section>

        <section class="card">
            <div class="card-title">ğŸ” Ø¨Ø­Ø« Ø§Ù„Ø£ØµÙ†Ø§Ù</div>

            <div class="search-grid">
                <div class="field-group">
                    <label for="search1">ÙƒÙ„Ù…Ø© Ø¨Ø­Ø« 1</label>
                    <input type="text" id="search1" placeholder="Ù…Ø«Ø§Ù„: Ø¯Ù‚">
                </div>
                <div class="field-group">
                    <label for="search2">ÙƒÙ„Ù…Ø© Ø¨Ø­Ø« 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="text" id="search2" placeholder="Ù…Ø«Ø§Ù„: ØªØ±ÙƒÙŠ">
                </div>
                <div class="field-group">
                    <label for="search3">ÙƒÙ„Ù…Ø© Ø¨Ø­Ø« 3 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="text" id="search3" placeholder="Ù…Ø«Ø§Ù„: Ø§Ø®Ø¶Ø±">
                </div>
                <div class="field-group">
                    <label for="warehouse">Ø¬Ø²Ø¡ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="text" id="warehouse" placeholder="Ù…Ø«Ø§Ù„: Ø¯ÙŠÙˆØ§Ù† Ø£Ùˆ 3-">
                </div>
            </div>

            <div class="search-actions">
                <button class="btn-primary" onclick="search()">
                    ğŸ” Ø¨Ø­Ø«
                </button>
                <button class="btn-secondary" onclick="clearSearch()">
                    ğŸ§¹ Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
                </button>
            </div>
        </section>

        <section class="card">
            <div class="card-title">ğŸ“‹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</div>
            <div class="table-wrapper">
                <table id="results" style="display:none;">
                    <thead>
                    <tr>
                        <th>Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹</th>
                        <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                        <th>Ø§Ù„Ø¹Ø¯Ø¯</th>
                        <th>Ø³Ø¹Ø± Ø§Ù„Ù…Ø¨ÙŠØ¹</th>
                    </tr>
                    </thead>
                    <tbody id="resultsBody"></tbody>
                </table>
            </div>
        </section>
    </main>
</div>

<script>
    let data = [];

    function formatQty(value) {
    const num = Number(value);
    if (isNaN(num)) return value || '';
    // Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ù…Ø¹ ÙÙˆØ§ØµÙ„ Ø¢Ù„Ø§Ù ÙˆØ¨Ø¯ÙˆÙ† ÙƒØ³ÙˆØ±
    return num.toLocaleString('en-US', { maximumFractionDigits: 0 });
	}


    function formatPrice(value) {
    const num = Number(value);
    if (isNaN(num)) return value || '';
    // Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ù…Ø¹ ÙÙˆØ§ØµÙ„ Ø¢Ù„Ø§Ù ÙˆØ±Ù‚Ù…ÙŠÙ† Ø¹Ø´Ø±ÙŠÙŠÙ†
    return num.toLocaleString('en-US', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
    });
	}


    // Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ù„ÙˆÙ† Ø«Ø§Ø¨Øª Ù„ÙƒÙ„ Ù…Ø³ØªÙˆØ¯Ø¹
    function getColorForWarehouse(name) {
    if (!name) return '#ffffff';

    const lower = name.toString().toLowerCase();

    // Ù…Ø³ØªÙˆØ¯Ø¹ ÙÙŠÙ‡ ÙƒÙ„Ù…Ø© "Ø¯ÙŠÙˆØ§Ù†" â†’ Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­ ÙˆØ§Ø¶Ø­
    if (lower.includes('Ø¯ÙŠÙˆØ§Ù†')) {
        return '#d0e7ff'; // Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­
    }

    const colors = [
        '#e8f5e9', // Ø£Ø®Ø¶Ø± ÙØ§ØªØ­
        '#fff3e0', // Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ ÙØ§ØªØ­
        '#f3e5f5', // Ø¨Ù†ÙØ³Ø¬ÙŠ ÙØ§ØªØ­
        '#e0f7fa', // Ø³Ù…Ø§ÙˆÙŠ ÙØ§ØªØ­
        '#fbe9e7', // Ù…Ø´Ù…Ø´ÙŠ ÙØ§ØªØ­
        '#ede7f6', // Ø¨Ù†ÙØ³Ø¬ÙŠ Ø±Ù…Ø§Ø¯ÙŠ
        '#f9fbe7'  // Ø£ØµÙØ± Ø¨Ø§Ù‡Øª
    ];

    let hash = 0;
    for (let i = 0; i < name.length; i++) {
        hash = name.charCodeAt(i) + ((hash << 5) - hash);
    }
    const index = Math.abs(hash) % colors.length;
    return colors[index];
}


    async function loadExcel() {
        const statusEl = document.getElementById('loadStatus');
        try {
            statusEl.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Â«Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsxÂ» Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±...';
            const response = await fetch('Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsx');
            if (!response.ok) {
                statusEl.textContent = 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Â«Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsxÂ». ØªØ£ÙƒØ¯ Ø£Ù†Ù‡ Ù…Ø±ÙÙˆØ¹ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ù…Ø¹ index.html.';
                return;
            }
            const arrayBuffer = await response.arrayBuffer();
            const workbook = XLSX.read(new Uint8Array(arrayBuffer), {type: 'array'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const allRows = XLSX.utils.sheet_to_json(sheet, {header:1});
            data = allRows.slice(3); // Ù…Ù† Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹
            statusEl.textContent = 'âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ' + data.length + ' ØµÙ†Ù Ù…Ù† Ø§Ù„Ù…Ù„Ù.';
        } catch (e) {
            console.error(e);
            statusEl.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù. Ø±Ø§Ø¬Ø¹ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„.';
        }
    }

    function clearSearch() {
        document.getElementById('search1').value = '';
        document.getElementById('search2').value = '';
        document.getElementById('search3').value = '';
        document.getElementById('warehouse').value = '';
        document.getElementById('resultsBody').innerHTML = '';
        document.getElementById('results').style.display = 'none';
    }

    function search() {
    if (data.length === 0) {
        alert('â— Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯. ØªØ£ÙƒØ¯ Ø£Ù† Ù…Ù„Ù Â«Ø¬Ø±Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¯.xlsxÂ» Ù…ÙˆØ¬ÙˆØ¯ ÙˆØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ÙƒØ§Ù…Ù„Ø©.');
        return;
    }

    const s1 = document.getElementById('search1').value.trim().toLowerCase();
    const s2 = document.getElementById('search2').value.trim().toLowerCase();
    const s3 = document.getElementById('search3').value.trim().toLowerCase();
    const wh = document.getElementById('warehouse').value.trim().toLowerCase();

    // Ù„Ùˆ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙØ§Ø¶ÙŠØ© â†’ Ø±Ø¬Ù‘Ø¹ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¯ÙˆÙ† ÙÙ„ØªØ±Ø©
    let results;
    if (!s1 && !s2 && !s3 && !wh) {
        results = [...data]; // Ù†Ø³Ø®Ø© Ù…Ù† ÙƒÙ„ Ø§Ù„ØµÙÙˆÙ
    } else {
        results = data.filter(row => {
            const warehouse = ((row[1] || '') + '').toLowerCase(); // B
            const itemName  = ((row[2] || '') + '').toLowerCase(); // C

            const match1 = !s1 || itemName.includes(s1);
            const match2 = !s2 || itemName.includes(s2);
            const match3 = !s3 || itemName.includes(s3);
            const matchWh = !wh || warehouse.includes(wh);

            return match1 && match2 && match3 && matchWh;
        });
    }

    // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©
    results.sort((a, b) => {
        const nameA = (a[2] || '').toString();
        const nameB = (b[2] || '').toString();
        return nameA.localeCompare(nameB, 'ar');
    });

    const tbody = document.getElementById('resultsBody');
    tbody.innerHTML = '';

    if (results.length === 0) {
        tbody.innerHTML = '<tr><td colspan="4" class="no-results">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©</td></tr>';
    } else {
        results.forEach(row => {
            const warehouse = row[1] || '';
            const itemName  = row[2] || '';
            const qtyRaw    = row[3];
            const priceRaw  = row[4];

            const qty   = formatQty(qtyRaw);
            const price = formatPrice(priceRaw);

            const tr = document.createElement('tr');
            const bgColor = getColorForWarehouse(warehouse.toString());
            tr.style.backgroundColor = bgColor;

            tr.innerHTML = `
                <td>${warehouse}</td>
                <td>${itemName}</td>
                <td>${qty}</td>
                <td>${price}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    document.getElementById('results').style.display = 'table';
}


        // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©
        results.sort((a, b) => {
            const nameA = (a[2] || '').toString();
            const nameB = (b[2] || '').toString();
            return nameA.localeCompare(nameB, 'ar');
        });

        const tbody = document.getElementById('resultsBody');
        tbody.innerHTML = '';

        if (results.length === 0) {
            tbody.innerHTML = '<tr><td colspan="4" class="no-results">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©</td></tr>';
        } else {
            results.forEach(row => {
                const warehouse = row[1] || '';
                const itemName  = row[2] || '';
                const qtyRaw    = row[3];
                const priceRaw  = row[4];

                const qty   = formatQty(qtyRaw);
                const price = formatPrice(priceRaw);

                const tr = document.createElement('tr');
                const bgColor = getColorForWarehouse(warehouse.toString());
                tr.style.backgroundColor = bgColor;

                tr.innerHTML = `
                    <td>${warehouse}</td>
                    <td>${itemName}</td>
                    <td>${qty}</td>
                    <td>${price}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        document.getElementById('results').style.display = 'table';
    }

    loadExcel();
</script>
</body>
</html>
